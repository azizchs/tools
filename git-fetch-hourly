#!/bin/sh
#
# Update git repo clones
#

fetch_repo()
{
	_git_dir=${1}

	echo "Fetching ${_git_dir}"

	git -C "${_git_dir}" fetch --prune
	git -C "${_git_dir}" reset --hard FETCH_HEAD
	date > "${_git_dir}"/.fetched
}

for git_dir in * ; do
	if [ -d "${git_dir}" ] && [ "${git_dir%.git}" = "${git_dir}" ] ; then
		fetch_repo "${git_dir}"
	fi
done
